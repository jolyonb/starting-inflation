(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     24758,        783]
NotebookOptionsPosition[     22167,        700]
NotebookOutlinePosition[     22580,        718]
CellTagsIndexPosition[     22537,        715]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Sweep Visualizations", "Section"],

Cell["Set the working directory.", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input"],

Cell["Import data.", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Import", "[", "\"\<calibration-combined.csv\>\"", "]"}]}], 
  ";"}]], "Input"],

Cell["\<\
Data comes in 11 columns:
1: phi0
2: phi0dot
3: H
4: rho
5:  deltarho2
6: phi2pt
7: psirms
8: efolds
9: kappa
10: inflated (0 -> Did not inflate, 1 -> Did inflate)
11: type (0 -> Hartree Off, 1 -> Bunch Davies, 2-> Perturbed)
12: filename
13: runtime (in seconds)\
\>", "Text"],

Cell["Which index do you want to work with?", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"index", "=", "8"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"names", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<\[Phi]0\>\"", ",", 
     "\"\<\!\(\*OverscriptBox[\(\[Phi]\), \(.\)]\)0\>\"", ",", "\"\<H\>\"", 
     ",", "\"\<\[Rho]\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(\[Delta]\[Rho]\), \(2\)]\)\>\"", ",", 
     "\"\<<\!\(\*SuperscriptBox[\(\[Delta]\[Phi]\), \(2\)]\)>\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(\[Psi]\), \(RMS\)]\)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(N\), \(e - folds\)]\)\>\"", ",", 
     "\"\<\[Kappa]\>\"", ",", "\"\<Inflated\>\"", ",", "\"\<Type\>\"", ",", 
     "\"\<Filename\>\"", ",", "\"\<runtime\>\""}], "}"}]}], ";"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"criticalEfolds", "=", "65"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"critplane", "=", 
   RowBox[{"Plot3D", "[", "\[IndentingNewLine]", 
    RowBox[{"criticalEfolds", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "50"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ColorFunction", "\[Rule]", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.5", ",", "0.5", ",", "0.5", ",", "0.5"}], "]"}]}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input"],

Cell["Select all \[Phi]0 and \[Phi]0dot values.", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Phi]0vals", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"data", "[", 
      RowBox[{"[", 
       RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]0dotvals", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"data", "[", 
      RowBox[{"[", 
       RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "/@", 
  RowBox[{"{", 
   RowBox[{"\[Phi]0vals", ",", "\[Phi]0dotvals"}], "}"}]}]}], "Input"],

Cell[CellGroupData[{

Cell["Functions", "Subsection"],

Cell["Select specific kinds of data", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Selects", " ", "Hartree", " ", "off", " ", "data", " ", "only"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SelectOff", "[", "data_", "]"}], ":=", 
    RowBox[{"Select", "[", 
     RowBox[{"data", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "11", "]"}], "]"}], "\[Equal]", "0"}], "&"}]}], "]"}]}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Selects", " ", "Bunch", " ", "Davies", " ", "data", " ", "only"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SelectBD", "[", "data_", "]"}], ":=", 
    RowBox[{"Select", "[", 
     RowBox[{"data", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "11", "]"}], "]"}], "\[Equal]", "1"}], "&"}]}], "]"}]}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Selects", " ", "perturbed", " ", "data", " ", "only"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SelectPerturbed", "[", "data_", "]"}], ":=", 
    RowBox[{"Select", "[", 
     RowBox[{"data", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "11", "]"}], "]"}], "==", "2"}], "&"}]}], 
     "]"}]}]}]}]], "Input"],

Cell["\<\
Extract specific types of data (specify the column number that you want)\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SelectQuantity", "[", 
   RowBox[{"data_", ",", "index_"}], "]"}], ":=", 
  RowBox[{"data", "[", 
   RowBox[{"[", 
    RowBox[{";;", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "index"}], "}"}]}], "]"}], "]"}]}]], "Input"],

Cell["Helper function to find index for a value in a list.", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindIndex", "[", 
   RowBox[{"value_", ",", "list_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Position", "[", 
    RowBox[{"list", ",", "value"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Hartree Off", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"workingoff", "=", 
   RowBox[{"SelectOff", "[", "data", "]"}]}], ";"}], "\n", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Plotting \>\"", " ", "<>", " ", 
   RowBox[{"names", "[", 
    RowBox[{"[", "index", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"offplot", "=", 
   RowBox[{"ListPlot3D", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SelectQuantity", "[", 
      RowBox[{"workingoff", ",", "index"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"names", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"names", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"names", "[", 
         RowBox[{"[", "index", "]"}], "]"}]}], "}"}]}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
        RowBox[{
         RowBox[{"ColorData", "[", "\"\<NeonColors\>\"", "]"}], "[", "z", 
         "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"offplot", ",", "critplane"}], "]"}]}], "Input"],

Cell["Same thing, but in ContourPlot form.", "Text"],

Cell[BoxData[
 RowBox[{"ListContourPlot", "[", 
  RowBox[{
   RowBox[{"SelectQuantity", "[", 
    RowBox[{"workingoff", ",", "index"}], "]"}], ",", 
   RowBox[{"Contours", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"45", ",", "50", ",", "55", ",", "60", ",", "65", ",", "70"}], 
     "}"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"names", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"names", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}]}], "]"}]], "Input"],

Cell["This is the critical line.", "Text"],

Cell[BoxData[
 RowBox[{"Offline", "=", 
  RowBox[{"ListContourPlot", "[", 
   RowBox[{
    RowBox[{"SelectQuantity", "[", 
     RowBox[{"workingoff", ",", "index"}], "]"}], ",", 
    RowBox[{"Contours", "\[Rule]", 
     RowBox[{"{", "criticalEfolds", "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"names", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"names", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ",", 
    RowBox[{"ColorFunction", "\[Rule]", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
       RowBox[{"RGBColor", "[", 
        RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}]}], "]"}]}], ",", 
    RowBox[{"ContourStyle", "\[Rule]", "Blue"}]}], "]"}]}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bunch-Davies", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"workingbd", "=", 
   RowBox[{"SelectBD", "[", "data", "]"}]}], ";"}], "\n", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Plotting \>\"", " ", "<>", " ", 
   RowBox[{"names", "[", 
    RowBox[{"[", "index", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bdplot", "=", 
   RowBox[{"ListPlot3D", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SelectQuantity", "[", 
      RowBox[{"workingbd", ",", "index"}], "]"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"names", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"names", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"names", "[", 
         RowBox[{"[", "index", "]"}], "]"}]}], "}"}]}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
        RowBox[{
         RowBox[{"ColorData", "[", "\"\<NeonColors\>\"", "]"}], "[", "z", 
         "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"bdplot", ",", "critplane"}], "]"}]}], "Input"],

Cell["Same thing, but in ContourPlot form.", "Text"],

Cell[BoxData[
 RowBox[{"ListContourPlot", "[", 
  RowBox[{
   RowBox[{"SelectQuantity", "[", 
    RowBox[{"workingbd", ",", "index"}], "]"}], ",", 
   RowBox[{"Contours", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"45", ",", "50", ",", "55", ",", "60", ",", "65", ",", "70"}], 
     "}"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"names", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"names", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}]}], "]"}]], "Input"],

Cell["This is the critical line.", "Text"],

Cell[BoxData[
 RowBox[{"BDline", "=", 
  RowBox[{"ListContourPlot", "[", 
   RowBox[{
    RowBox[{"SelectQuantity", "[", 
     RowBox[{"workingbd", ",", "index"}], "]"}], ",", 
    RowBox[{"Contours", "\[Rule]", 
     RowBox[{"{", "criticalEfolds", "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"names", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"names", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ",", 
    RowBox[{"ColorFunction", "\[Rule]", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
       RowBox[{"RGBColor", "[", 
        RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}]}], "]"}]}], ",", 
    RowBox[{"ContourStyle", "\[Rule]", "Red"}]}], "]"}]}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Perturbed", "Subsection"],

Cell[CellGroupData[{

Cell["Obtaining statistics", "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"workingperturbed", "=", 
   RowBox[{"SelectPerturbed", "[", "data", "]"}]}], ";"}]], "Input"],

Cell["\<\
Workhorse function that takes in the desired data, and outputs a list of {\
\[Phi]0, \[Phi]0dot, mean, \[Sigma]} values.\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExtractStats", "[", 
   RowBox[{"data_", ",", "index_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"grid", ",", "i", ",", "efolds", ",", "mean", ",", "sd"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Start", " ", "by", " ", "sorting", " ", "all", " ", "the", " ", "data", 
      " ", "by", " ", "\[Phi]0", " ", "and", " ", "\[Phi]0dot", " ", 
      "value"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"grid", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", "j", ",", 
          RowBox[{"{", "}"}]}], "}"}], " ", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "\[Phi]0vals"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "\[Phi]0dotvals"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"grid", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"FindIndex", "[", 
             RowBox[{
              RowBox[{"i", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "\[Phi]0vals"}], "]"}], 
            ",", 
            RowBox[{"FindIndex", "[", 
             RowBox[{
              RowBox[{"i", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "\[Phi]0dotvals"}], "]"}],
             ",", "3"}], "]"}], "]"}], ",", "\[IndentingNewLine]", "i"}], 
        "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "data"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Flatten", " ", "into", " ", "a", " ", "list"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"grid", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"grid", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Compute", " ", "statistics"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "grid", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"efolds", "=", 
         RowBox[{
          RowBox[{"grid", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", ";;", ",", "index"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mean", "=", 
         RowBox[{"Mean", "[", "efolds", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sd", "=", 
         RowBox[{"StandardDeviation", "[", "efolds", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"grid", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"grid", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", 
             RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "~", "Join", "~", 
          RowBox[{"{", 
           RowBox[{"mean", ",", "sd"}], "}"}]}]}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Report", " ", "results"}], " ", "*)"}], "\[IndentingNewLine]", 
     "grid"}]}], "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell["Obtain all the statistics.", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stats", "=", 
   RowBox[{"ExtractStats", "[", 
    RowBox[{"workingperturbed", ",", "index"}], "]"}]}], ";"}]], "Input"],

Cell["Find any points with suspiciously large standard deviations.", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FindPoints", "[", 
   RowBox[{"data_", ",", "entry_"}], "]"}], ":=", 
  RowBox[{"data", "[", 
   RowBox[{"[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Position", "[", 
      RowBox[{
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
       RowBox[{"entry", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], "]"}], "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"badpoints", "=", 
  RowBox[{"Select", "[", 
   RowBox[{"stats", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "4", "]"}], "]"}], ">", "1.0"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FindPoints", "[", 
     RowBox[{"data", ",", "#"}], "]"}], "&"}], ",", "badpoints"}], 
  "]"}]}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plotting", "Subsubsection"],

Cell["\<\
stats now contains a list of {phi0, phi0dot, mean, \[Sigma]} values.\
\>", "Text"],

Cell["\<\
Here is a function to add a specified number of standard deviations to the \
means, returning data ready for plotting.\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Add\[Sigma]", "[", 
   RowBox[{"data_", ",", "\[Sigma]s_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"result", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "data", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"result", ",", 
         RowBox[{
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], "~", "Join", 
          "~", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], "+", 
            RowBox[{"\[Sigma]s", " ", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "4"}], "]"}], "]"}]}]}], "}"}]}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "result"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell["Here are the means.", "Text"],

Cell[BoxData[
 RowBox[{"means", "=", 
  RowBox[{"ListPlot3D", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Add\[Sigma]", "[", 
     RowBox[{"stats", ",", "0"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"AxesLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"names", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"names", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"names", "[", 
        RowBox[{"[", "index", "]"}], "]"}]}], "}"}]}], ",", 
    RowBox[{"ColorFunction", "\[Rule]", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
       RowBox[{"Hue", "[", 
        RowBox[{".65", 
         RowBox[{"(", 
          RowBox[{"1", "-", "z"}], ")"}]}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell["Here are the standard deviations.", "Text"],

Cell[BoxData[
 RowBox[{"\[Sigma]s", "=", 
  RowBox[{"ListPlot3D", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stats", "[", 
     RowBox[{"[", 
      RowBox[{";;", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"AxesLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"names", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"names", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<\[Sigma]\>\""}], "}"}]}], 
    ",", 
    RowBox[{"ColorFunction", "\[Rule]", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
       RowBox[{"Hue", "[", 
        RowBox[{".65", 
         RowBox[{"(", 
          RowBox[{"1", "-", "z"}], ")"}]}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell["\<\
We can compare the means to Bunch-Davies and the critical plane.\
\>", "Text"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"means", ",", "bdplot", ",", "critplane"}], "]"}]], "Input"],

Cell["Here\[CloseCurlyQuote]s a contour plot of the means.", "Text"],

Cell[BoxData[
 RowBox[{"ListContourPlot", "[", 
  RowBox[{
   RowBox[{"Add\[Sigma]", "[", 
    RowBox[{"stats", ",", "0"}], "]"}], ",", 
   RowBox[{"Contours", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"45", ",", "50", ",", "55", ",", "60", ",", "65", ",", "70"}], 
     "}"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"names", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"names", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}]}], "]"}]], "Input"],

Cell["\<\
Here\[CloseCurlyQuote]s the critical line for the means, means +- 2\[Sigma], \
the Bunch-Davies result in red, and the Hartree off result in blue.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pm", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ListContourPlot", "[", 
      RowBox[{
       RowBox[{"Add\[Sigma]", "[", 
        RowBox[{"stats", ",", "i"}], "]"}], ",", 
       RowBox[{"Contours", "\[Rule]", 
        RowBox[{"{", "criticalEfolds", "}"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"names", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"names", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"ColorFunction", "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}]}], "]"}]}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "pm", ",", 
         RowBox[{"-", "pm"}]}], "}"}]}], "}"}]}], "]"}], ",", "BDline", ",", 
   "Offline"}], "]"}]}], "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440, 1030},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TrackCellChangeTimes->False,
Magnification:>1.5 Inherited,
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 28, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 39, 0, 95, "Section"],
Cell[622, 24, 42, 0, 46, "Text"],
Cell[667, 26, 123, 3, 48, "Input"],
Cell[793, 31, 28, 0, 46, "Text"],
Cell[824, 33, 138, 4, 48, "Input"],
Cell[965, 39, 287, 15, 430, "Text"],
Cell[1255, 56, 53, 0, 46, "Text"],
Cell[1311, 58, 71, 2, 48, "Input"],
Cell[1385, 62, 645, 13, 51, "Input"],
Cell[2033, 77, 757, 19, 173, "Input"],
Cell[2793, 98, 57, 0, 46, "Text"],
Cell[2853, 100, 626, 19, 111, "Input"],
Cell[CellGroupData[{
Cell[3504, 123, 31, 0, 65, "Subsection"],
Cell[3538, 125, 45, 0, 46, "Text"],
Cell[3586, 127, 1305, 39, 204, "Input"],
Cell[4894, 168, 96, 2, 46, "Text"],
Cell[4993, 172, 272, 8, 48, "Input"],
Cell[5268, 182, 68, 0, 46, "Text"],
Cell[5339, 184, 264, 8, 48, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5640, 197, 33, 0, 65, "Subsection"],
Cell[5676, 199, 1267, 33, 266, "Input"],
Cell[6946, 234, 52, 0, 46, "Text"],
Cell[7001, 236, 597, 16, 80, "Input"],
Cell[7601, 254, 42, 0, 46, "Text"],
Cell[7646, 256, 844, 22, 111, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8527, 283, 34, 0, 65, "Subsection"],
Cell[8564, 285, 1268, 34, 266, "Input"],
Cell[9835, 321, 52, 0, 46, "Text"],
Cell[9890, 323, 596, 16, 80, "Input"],
Cell[10489, 341, 42, 0, 46, "Text"],
Cell[10534, 343, 841, 22, 111, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11412, 370, 31, 0, 65, "Subsection"],
Cell[CellGroupData[{
Cell[11468, 374, 45, 0, 52, "Subsubsection"],
Cell[11516, 376, 128, 3, 48, "Input"],
Cell[11647, 381, 144, 3, 46, "Text"],
Cell[11794, 386, 3411, 88, 638, "Input"],
Cell[15208, 476, 42, 0, 46, "Text"],
Cell[15253, 478, 155, 4, 48, "Input"],
Cell[15411, 484, 76, 0, 46, "Text"],
Cell[15490, 486, 947, 31, 111, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16474, 522, 33, 0, 52, "Subsubsection"],
Cell[16510, 524, 92, 2, 46, "Text"],
Cell[16605, 528, 142, 3, 46, "Text"],
Cell[16750, 533, 1295, 35, 235, "Input"],
Cell[18048, 570, 35, 0, 46, "Text"],
Cell[18086, 572, 868, 24, 142, "Input"],
Cell[18957, 598, 49, 0, 46, "Text"],
Cell[19009, 600, 912, 27, 142, "Input"],
Cell[19924, 629, 88, 2, 46, "Text"],
Cell[20015, 633, 107, 2, 48, "Input"],
Cell[20125, 637, 68, 0, 46, "Text"],
Cell[20196, 639, 585, 16, 80, "Input"],
Cell[20784, 657, 170, 3, 46, "Text"],
Cell[20957, 662, 1170, 33, 111, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

